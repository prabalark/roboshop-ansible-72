#- name: schema mongodb
#  when: schema == "mongo"
#  ansible.builtin.block:
#    - name : copy ansible file
#      ansible.builtin.copy:
#        src: mongo.repo
#        dest: /etc/yum.repos.d/mongo.repo
#
#    - name: install mongodb client
#      ansible.builtin.yum:
#        name: mongodb-org-shell
#        state: installed
#
#    - name: load schema
#      ansible.builtin.shell: mongo --host {{ lookup('aws_ssm','dev.frontend.catalogue_mongoendpoint',region='us-east-1' }} </app/schema/${component}.js
- name: copy ansible file
  ansible.builtin.copy:
    src: mongo.repo
    dest: /etc/yum.repos.d/mongo.repo
  when: schema == "mongo"

- name: install mongodb client
  ansible.builtin.yum:
    name: mongodb-org-shell
    state: installed
  when: schema == "mongo"

- name: load schema
  ansible.builtin.shell: mongo --host {{ lookup('aws_ssm','dev.frontend.catalogue_mongoendpoint',region='us-east-1') }} </app/schema/{{component}}.js
  when: schema == "mongo"